# 数据库

### 数据库系统

#### 数据库系统组成

##### 1.计算机硬件

##### 2.数据库

##### 3.计算机软件

操作系统、数据库管理系统、数据库开发工具、数据库应用系统

###### 数据库管理系统

主要功能：

1.数据库的定义功能

2.数据库的操纵功能

3.数据库的保护功能

4.数据库的维护功能

5.数据字典

##### 4.人员

#### 数据库系统结构

##### 三级模式体系结构

外模式

内模式

##### 两级映像：概念模式/内模式、外模式/概念模式

#### 数据模型

##### 数据处理的三个阶段



##### 概念模型

###### 实体、联系模型

###### E-R图

###### 

##### 逻辑模型

逻辑设计过程分为E-R图向关系模式的转换、关系规范化处理、对关系模式进行评价和修正

###### 关系模式的转换

关系模式由一组关系（二维表）组成，而E-R图则是由实体、实体对应属性、实体间的相互联系三个要素组成。

转换的过程遵守以下规则：

1.实体

每个实体转换为一个关系模式，实体的属性转换为关系的属性，标识符则转换为关系的键。

2.二元联系类型

若联系为1:1，则可以在两个实体类型转换成的两个关系模式中的任意一个关系模式的属性中加入另一个关系模式的键和联系类型的属性。

若联系为1:N，则在N端实体类型转换成的关系中加入1端实体类型转换成的关系模式的键和联系类型的属性

若弱实体间的联系为1:N，且N端实体类型为弱实体，转成关系模式时，将1端实体类型(父表)的键作为外键放在N端的弱实体类型（子表）中，若实体的主键由父表的主键和子表本身的候选键组成，也可以为弱实体新建一个ID

注：一个实体的主键的部分或全部从其依赖主体中获得，则称该实体为弱实体



若实体间的联系为M:N,则两端实体和其联系分别转换为关系模式，联系的属性为两端实体类型的键加上联系类型的属性，键是包含两端实体键的组合

3.三元联系类型

(1)若实体间的联系是 1:1:1，可以在三个实体类型转换成的三个关系模式中任意一个关系模式的属性中加另两个关系模式的键和联系类型的属性。
(2)若实体间的联系是1:1:N，则在N端实体类型转换成的关系模式中加入1端实体类型的键和联系类型的属性。
(3)若实体间的联系是 1:M:N，则将联系类型也转换成关系模式，属性为1端、M端和N端实体类型的键加上联系类型的属性，而键是包含M端和N端实体键的组合。
(4)若实体间的联系是 M:N:P，则将联系类型也转换成关系模式，属性为三端实体类型的键加上联系类型的属性，而键是包含三端实体键的组合。





















##### 物理模型

##### 常见数据模型

逻辑结构： 传统：

​					非传统：

数据描述

物理描述

### 关系数据模型

#### 关系数据结构

##### 关系模式

元数

基数

字段

##### 键、码、关键字：

##### 关系模式、关系子模式、存储模式

#### 关系运算：

##### 基本关系运算

##### 关系运算的表示

#### 关系的完整性约束

##### 域完整性约束

##### 实体完整性约束

##### 参照完整性约束

##### 用户定义完整性约束

#### 关系代数的基本理论：

##### 传统的集合运算：

并运算

交运算

差运算

笛卡尔积

##### 专门的集合运算

选择

投影

###### 连接

#### 关系数据库的规范化理论

##### 函数依赖

##### 完全函数依赖、部分函数依赖

##### 传递函数依赖

##### Armstrong推理

#### 关系范式及规范化

##### 第一范式

##### 第二范式

##### 第三范式

##### BC范式

#### 关系模式的分解

##### 模式分解

##### 无损分解：Heath定理

##### 保持函数依赖分解

##### 关系模式分解原则

##### 3NF分解

### 数据库设计方法

#### 数据库设计基本步骤

1.需求分析阶段

2.概念结构设计阶段

3.逻辑结构设计阶段

4.物理结构设计阶段

5.数据库实施阶段

6.数据库运行和维护阶段

#### 需求分析

##### 需求分析的任务和目标

##### 需求分析的步骤

##### 数据流图

##### 数据字典

#### 概念结构设计

##### 概念结构设计基本方法

##### 概念结构设计主要步骤

##### 局部E-R模型的设计

##### 全局E-R模型的设计

#### 逻辑结构设计

##### E-R模型向关系模式的转换



#### 物理结构设计

##### 设计物理结构

#### 数据库实施运行维护

### Transact-SQL

#### 语法基础

##### 常用数据类型

##### 常量

##### 变量

##### 输出语句

##### 常用预算符

#### 流程控制语句

##### begin...end语句

##### 分支语句

##### 循环语句

##### return语句

##### try...catch语句

### SQL Server存储机制

#### SQL Server数据页

##### SQL Server数据页类型

##### DBCC命令

### 数据库和数据表管理

### 数据查询与游标机制

#### 基本查询

##### select语句结构

##### 简单查询

###### 查询指定列

```
use DB1
select column1,column2
from table1
```

###### 查询全部列

```
use DB1
select *
from table1
```

###### 查询经过计算的值

```
use DB1
select 算术表达式（如column1 - 某常量）
from table1
```

###### 通过指定别名来改变查询结果的列标题

```
use DB1
select column1 as'列1'
from table1
```



##### 带where子句查询

###### 比较值

```
use DB1
select column1
from table1
where property1='vlue1' 或 property1<'vlue1' ……
```

###### 确定范围

```
use DB1
select column1
from table1
where property1 between 'value1' and 'value2'
与此对应还有一个 not between... and...
```

###### 确定集合

```
use DB1
select column1
from table1
where property1 in ('value1','value2','value3')
与此对应还有一个 not in
```

###### 字符匹配

运算符like可以用来进行字符串的匹配。其一般语法格式如下：

```
LIKE'<匹配串>'[ESCAPE'<换码字符>']
<匹配串>可以是一个完整的字符串，也可以含有通配符“%”和“_”。
其中：%(百分号)代表任意长度（长度可以为0）的字符串。
	 _(下画线)一代表任意单个字符。
与此对应还有一个 not like
如果匹配串中不含通配符，则like可以用'='代替，not lke 用'<>'代替
```

###### 空值的查询

```
use DB1
select column1
from table1
where porperty1 is null
相对的还有 is not null 
注意 is 不能用= 代替
```

###### 多重条件查询

用and或or来联结多个查询条件，and的优先级大于or，但可以用括号来改变优先级

##### 带order by 子句的查询

```
use DB1
select column1
from table1
oreder by porperty1 asc (升序排列) 或oreder by porperty1 desc (降序排列)
升序null值在前，降序则在后
```



##### 带 group by子句的查询

##### 输出结果选项

###### 输出前n行

###### 查询结果集输出到新建表中

##### 联合查询

###### 集合并运算

###### 集合交运算

###### 集合差运算

#### 多表查询

##### 连接查询

###### 内连接

###### 外连接

###### 交叉连接

##### 子查询

###### 无关子查询

###### 相关子查询

###### 表数据维护的子查询

#### 游标机制

##### 游标概述

##### 游标的管理

##### 利用游标修改和删除表数据

### 视图与索引

### 视图

#### 视图的基本概念







