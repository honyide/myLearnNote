## 网络层

### 网络层提供的两种服务

面向连接/无连接？可靠交付由谁来负责

网络层只向上提供简单灵活的、无连接的、尽最大努力交付的数据报服务

### 网络协议IP

与IP协议配套的三个协议

#### 虚拟互连网络

把网络相互连接起来的中间设备：四种

直接交付、间接交付、异构网络

#### 分类的IP地址

##### IP地址的表示方法

ICANN

IP编址方法的三个阶段

一个IP地址在整个互联网范围内是唯一的

符号::=

单播地址、多播地址、保留地址

点分十进制

##### 常见的三类IP地址

IP地址的指派范围

特殊的IP地址

IP地址的重要特点

### 互联网中的IP地址

同一个局域网上的主机或路由器的Ip地址中的网络号必须是一样的

 路由器总具有两个及以上的IP地址，路由器的每一个接口都有一个不同网络号的IP地址

####  IP地址与硬件地址

从层次的角度比较：



#### 地址解析协议ARP

当主机A要向本局域网上的某个主机B发送IP数据报时，先在其ARP高速缓存中查看有无主机B的IP地址

​	如果有，就可查出对应的硬件地址，再将此硬件地址写入MAC帧，再通过局域网将该MAC帧发往此硬件地址

​	如果没有，ARP进程在本局域网上广播发送一个ARP请求分组，收到ARP响应分组后，将得到的IP地址到硬件地址的映射写入ARP高速缓存

ARP是解决同一个局域网上的主机或路由器的IP地址和硬件地址的映射问题



四种典型情况：

同一网络内通信（主机到主机）

从主机到路由器

从路由器到主机

路由器到路由器



为什么要用两种地址？ 



IP数据报的格式

由两部分组成：首部和数据

首部前一部分是固定长度，共20字节（160比特），使用IP数据报都必须具备

版本4比特+首部长度4比特（可表示的最大数值是15个单位，一个单位为4字节）+区分服务8比特+总长度16比特（整个IP数据报的总长度，总长度不能超过MTU）



标识16比特+标志3比特（目前只有前两位有意义MF、DF）+片偏移13比特（指出：较长的分组在分片后某片在原分组中的相对位置，片偏移以八个字节为偏移单位）



注意：可选字段的长度必须是4的整数倍

IP首部长度的最大值 





















